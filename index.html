<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <!-- <meta name='viewport' content='width=device-width, initial-scale=0.5, maximum-scale=1.0, user-scale=no'>-->
  <title>Data Dashboard</title>
  <!-- ApexCharts JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/apexcharts/3.44.0/apexcharts.min.js"></script>
  <style>
    body {
      font-family: pretendard;
      margin: 0;
      padding: 20px;
      background-color: #F3F4F6;
      -webkit-text-size-adjust: 100%;
    }
    
    * {
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    .container {
      max-width: 100%;
      margin: 0 auto;
    }
    
    .dashboard {
      width: 100%;
      overflow-x: auto;
      white-space: nowrap;
      display: flex;
      gap: 20px;
      margin-bottom: 20px;
    }
    
    .card-head {
      display: flex;
      flex-direction: row;
      justify-content: space-between;
      align-items: top;
    }
    
    .annotation {
      font-size: 12px;
      color: #6B7280;
      font-weight: 300;
    }

    .chart-block {
      flex: 1;
      min-width: 460px;
      background-color: #fff;
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }
    
    .chart-description {
      padding-bottom: 10px;
      border-bottom: 1px solid #eee;
    }
    
    .chart-description h3 {
      margin: 0;
      padding-bottom: 20px;
      color: #1F2A37
    }
    
    .chart-description p {
      margin: 0;
      padding-bottom: 10px;
      color: #6B7280;
      font-size: 15px;
      line-height: 22px;
    }
    
    .table-block {
      flex: 2;
      min-width: 460px;
      background-color: #fff;
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }
    
    .table-section {
      margin-bottom: 30px;
    }
    
    .table-description {
      padding-bottom: 10px;
    }
    
    .table-description h3 {
      margin: 0;
      padding-bottom: 20px;
      color: #1F2A37
    }
    
    .table-description p {
      margin: 0;
      padding-bottom: 10px;
      color: #6B7280;
      font-size: 14px;
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
    }
    
    table, th, td {
      border: 1px solid #ddd;
    }
    
    th, td {
      padding: 10px 4px;
      text-align: center;
      font-size: 13px;
    }
    
    th {
      background-color: #f2f2f2;
      color: #333;
    }
    
    tr:nth-child(even) {
      background-color: #f9f9f9;
    }
    
    .table-tabs {
      display: flex;
      margin-bottom: 10px;
      font-size: 12px;
    }
    
    .table-tab {
      padding: 8px 15px;
      background-color: #e9e9e9;
      border: 1px solid #ddd;
      border-bottom: none;
      border-radius: 4px 4px 0 0;
      margin-right: 5px;
      cursor: pointer;
    }
    
    .table-tab.active {
      background-color: #fff;
      border-bottom: 1px solid #fff;
      margin-bottom: -1px;
      font-weight: bold;
    }
    
    .table-content {
      display: none;
      font-size: 10px;
    }
    
    .table-content.active {
      display: flex;
      font-size: 10px;
      display: flex;
      flex-direction: row;
      gap: 10px;
    }

    #blue {
      font-weight: 600;
      color: #2E93FA
    }

    #red {
      font-weight: 600;
      color: #ED4B82
    }

    #yellow {
      font-weight: 600;
      color: #FF9800
    }

    #black {
      font-weight: 600;
      color: #1F2A37
    }

    #green {
      font-weight: 600;
      color: #00E396
    }
    

    @media (max-width: 768px) {

      .dashboard {
        flex-direction: column;
        justify-content: center;
        align-items: center;
      }

      .chart-block {
        flex: 1;
        min-width: 460px;
        background-color: #fff;
        border-radius: 8px;
        padding: 12px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      }
      .chart-description p {
        margin: 0;
        padding-bottom: 6px;
        color: #6B7280;
        font-size: 9px;
        line-height: 22px;
      }
      .table-block {
        flex: 2;
        min-width: 460px;
        background-color: #fff;
        border-radius: 8px;
        padding: 12px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      }
      .table-description p {
        margin: 0;
        padding-bottom: 6px;
        color: #6B7280;
        font-size: 8px;
      }
      th, td {
        padding: 6px 3px;
        text-align: center;
        font-size: 8px;
      }
      .table-tabs {
        display: flex;
        margin-bottom: 6px;
        font-size: 7px;
      }
      .table-content {
        display: none;
        font-size: 6px;
      }
      .table-content.active {
        display: flex;
        font-size: 6px;
        display: flex;
        flex-direction: row;
        gap: 6px;
      }

      .annotation {
        font-size: 7px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="dashboard">
      <!-- Chart Block 1: Treemap -->
      <div class="chart-block">
        <div class="chart-description">
          <h3>공정별 불량률</h3>
          <p>가장 문제가 높은 공정은 <span id="red">코팅 공정, 포장 공정</span>입니다.<br>
            ㅤ</p>
        </div>
        <div id="treemap-chart"></div>
      </div>
      
      <!-- Chart Block 2: Gradient Line -->
      <div class="chart-block">
        <div class="chart-description">
          <h3>코팅 공정 문제 발생률 추이</h3>
          <p>날짜별 <span id="black">코팅 공정의 문제 발생 추이</span>는 <span id="red">증가</span>하고 있으며,<br>
            지속적으로 증가할 것으로 예상됩니다.</p>
        </div>
        <div id="gradient-line-chart"></div>
      </div>
      
      <!-- Chart Block 3: Basic Bar -->
      <div class="chart-block">
        <div class="chart-description">
          <div class="card-head">
            <h3>코팅 공정 문제 종류와 순위</h3>
            <div class="annotation">불량률(%)</div>
          </div>
          <p>최근 7일간 코팅 공정에서 발생한 문제는 총 9개이며, 가장 높은 문제<br>
            TOP3는 <span id=yellow>코팅 불균일 문제, 점착성 문제, 코팅 박리</span> 입니다.</p>
        </div>
        <div id="basic-bar-chart"></div>
      </div>
      
      <!-- Chart Block 4: Simple Bubble -->
      <div class="chart-block">
        <div class="chart-description">
          <div class="card-head">
            <h3>코팅 공정 불량 설비 비율</h3>
            <div class="annotation"><span id=blue>●</span> 정상 <span id=green>●</span> 적정 <span id=yellow>●</span> 미세불량 <span id=red>●</span> 불량</div>
          </div>
          <p>코팅 불균일 문제에서 불량률이 높은 설비는 <span id=red>드라이어, 혼합기, 두께<br>
            측정</span>이며, <span id=black>4~6번 라인</span>에서 불량률이 높습니다.</p>
        </div>
        <div id="simple-bubble-chart"></div>
      </div>

      <!-- Block 5: Tables with Tabs -->
      <div class="table-block">
        <div class="table-description">
          <div class="card-head">
            <h3>불량 설비 순위 및 값</h3>
            <div class="annotation"><span id=blue>●</span> 정상 <span id=green>●</span> 적정 <span id=yellow>●</span> 미세불량 <span id=red>●</span> 불량</div>
          </div>
          <p>불량률이 높은 TOP5 설비는 <span id=black>드라이어 관련 설비들</span>입니다.<br>
            ㅤ</p>
        </div>
        
        <div class="table-tabs">
          <div class="table-tab active" onclick="switchTab('table1')">높은순</div>
          <div class="table-tab" onclick="switchTab('table2')">낮은순</div>
        </div>
        
        <!-- Table 1 -->
        <div id="table1" class="table-content active">
          <table>
            <thead>
              <tr>
                <th>No</th>
                <th>상태</th>
                <th>설비명</th>
                <th>불량률</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>1</td>
                <td><span id=red>●</span></td>
                <td>드라이어 4-5</td>
                <td>36%</td>
              </tr>
              <tr>
                <td>2</td>
                <td><span id=red>●</span></td>
                <td>혼합기 1-3</td>
                <td>33.9%</td>
              </tr>
              <tr>
                <td>3</td>
                <td><span id=red>●</span></td>
                <td>드라이어 5-2</td>
                <td>31%</td>
              </tr>
              <tr>
                <td>4</td>
                <td><span id=red>●</span></td>
                <td>드라이어 6-8</td>
                <td>27.3%</td>
              </tr>
              <tr>
                <td>5</td>
                <td><span id=red>●</span></td>
                <td>드라이어 5-4</td>
                <td>26%</td>
              </tr>
              <tr>
                <td>6</td>
                <td><span id=red>●</span></td>
                <td>두께측정 5-1</td>
                <td>18.5%</td>
              </tr>
              <tr>
                <td>7</td>
                <td><span id=red>●</span></td>
                <td>드라이어 4-0</td>
                <td>11.4</td>
              </tr>
            </tbody>
          </table>
          <table>
            <thead>
              <tr>
                <th>No</th>
                <th>상태</th>
                <th>설비명</th>
                <th>불량률</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>8</td>
                <td><span id=red>●</span></td>
                <td>혼합기 1-6</td>
                <td>9.1%</td>
              </tr>
              <tr>
                <td>9</td>
                <td><span id=red>●</span></td>
                <td>두께측정 1-3</td>
                <td>9.1%</td>
              </tr>
              <tr>
                <td>10</td>
                <td><span id=yellow>●</span></td>
                <td>혼합기 9-1</td>
                <td>8.2%</td>
              </tr>
              <tr>
                <td>11</td>
                <td><span id=yellow>●</span></td>
                <td>혼합기 2-7</td>
                <td>7%</td>
              </tr>
              <tr>
                <td>12</td>
                <td><span id=yellow>●</span></td>
                <td>두께측정 6-7</td>
                <td>1%</td>
              </tr>
              <tr>
                <td>13</td>
                <td><span id=yellow>●</span></td>
                <td>칼렌더 8-1</td>
                <td>0.5%</td>
              </tr>
              <tr>
                <td>14</td>
                <td><span id=yellow>●</span></td>
                <td>코팅기 8-4</td>
                <td>0.4</td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Table 2 -->
        <div id="table2" class="table-content">
          <table>
            <thead>
              <tr>
                <th>No</th>
                <th>상태</th>
                <th>설비명</th>
                <th>불량률</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>1</td>
                <td><span id=blue>●</span></td>
                <td>코팅액공급기 3-0</td>
                <td>0.1%</td>
              </tr>
              <tr>
                <td>2</td>
                <td><span id=blue>●</span></td>
                <td>칼렌더 3-6</td>
                <td>0.1%</td>
              </tr>
              <tr>
                <td>3</td>
                <td><span id=blue>●</span></td>
                <td>드라이어 3-7</td>
                <td>0.1%</td>
              </tr>
              <tr>
                <td>4</td>
                <td><span id=blue>●</span></td>
                <td>코팅기 3-1</td>
                <td>0.1%</td>
              </tr>
              <tr>
                <td>5</td>
                <td><span id=blue>●</span></td>
                <td>혼합기 8-3</td>
                <td>0.1%</td>
              </tr>
              <tr>
                <td>6</td>
                <td><span id=blue>●</span></td>
                <td>칼렌더 9-5</td>
                <td>0.1%</td>
              </tr>
              <tr>
                <td>7</td>
                <td><span id=blue>●</span></td>
                <td>칼렌더 3-8</td>
                <td>0.1</td>
              </tr>
            </tbody>
          </table>
          <table>
            <thead>
              <tr>
                <th>No</th>
                <th>상태</th>
                <th>설비명</th>
                <th>불량률</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>8</td>
                <td><span id=blue>●</span></td>
                <td>드라이어 3-2</td>
                <td>0.1%</td>
              </tr>
              <tr>
                <td>9</td>
                <td><span id=blue>●</span></td>
                <td>코팅액공급기 3-4</td>
                <td>0.1%</td>
              </tr>
              <tr>
                <td>10</td>
                <td><span id=blue>●</span></td>
                <td>혼합기 8-7</td>
                <td>0.15%</td>
              </tr>
              <tr>
                <td>11</td>
                <td><span id=blue>●</span></td>
                <td>두께측정 8-2</td>
                <td>0.2%</td>
              </tr>
              <tr>
                <td>12</td>
                <td><span id=green>●</span></td>
                <td>코팅액공급기 2-4</td>
                <td>0.9%</td>
              </tr>
              <tr>
                <td>13</td>
                <td><span id=green>●</span></td>
                <td>코팅기 2-0</td>
                <td>1.2%</td>
              </tr>
              <tr>
                <td>14</td>
                <td><span id=green>●</span></td>
                <td>드라이어 7-9</td>
                <td>1.5</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Tab switching function
    function switchTab(tabId) {
      // Hide all tabs
      document.querySelectorAll('.table-content').forEach(tab => {
        tab.classList.remove('active');
      });
      
      // Show selected tab
      document.getElementById(tabId).classList.add('active');
      
      // Update tab buttons
      document.querySelectorAll('.table-tab').forEach(btn => {
        btn.classList.remove('active');
      });
      
      // Find the button that triggered this and activate it
      Array.from(document.querySelectorAll('.table-tab')).find(
        btn => btn.innerText.toLowerCase().includes(tabId === 'table1' ? '높은순' : '낮은순')
      ).classList.add('active');
    }
    // 1. Treemap Chart
    const treemapOptions = {
      series: [{
        data: [
          {
            x: '펄프 준비 공정',
            y: -0.1
          },
          {
            x: '포밍 공정정',
            y: 0.1
          },
          {
            x: '코팅 공정',
            y: -0.3
          },
          {
            x: '혼합 및 첨가 공정',
            y: 0.2
          },
          {
            x: '건조 공정',
            y: -0.05
          },
          {
            x: '슬리팅 공정',
            y: 0.05
          },
          {
            x: '프레스 공정',
            y: 0.15
          },
          {
            x: '연마 공정',
            y: -0.05
          },
          {
            x: '컷팅 공정',
            y: 0.05
          },
          {
            x: '포장 공정',
            y: -0.2 
          }
        ]
      }],
      chart: {
        height: 350,
        type: 'treemap',
        toolbar: {
          show: false
        }
      },
      title: {
        align: 'center',
        style: {
          fontSize: '14px'
        }
      },
      dataLabels: {
        enabled: true,
        style: {
          fontSize: '12px'
        },
        formatter: function (text, op) {
          return [text, op.value + '%'];
        },
        offsetY: -5
      },
      plotOptions: {
        treemap: {
          distributed: true,
          enableShades: false,
          colorScale: {
            ranges: [{
              from: -1,
              to: -0.11,
              color: '#ED4B82'
            },
            {
              from: -0.1,
              to: -0.01,
              color: '#FF9800'
            },
            {
              from: 0,
              to: 1,
              color: '#2E93FA'
            }
            ]
          }
        }
      }
    };

    // 2. Gradient Line Chart
    const gradientLineOptions = {
      series: [{
        name: '',
        data: [4.8, 4.6, 7.5, 2.5, 5, 8.5, 7, 11, 10, 15, 18, 16, 18, 16]
      }],
      chart: {
        height: 350,
        type: 'line',
        toolbar: {
          show: false
        }
      },
      forecastDataPoints: {
        count: 4
      },
      dataLabels: {
        enabled: false
      },
      stroke: {
        curve: 'smooth',
        width: 3
      },
      grid: {
        borderColor: '#e7e7e7',
        row: {
          colors: ['#f3f3f3', 'transparent'],
          opacity: 0.5
        }
      },
      xaxis: {
        categories: ['10/1', '10/2', '10/3', '10/4', '10/5', '10/6', '10/7', '10/8', '10/9', '10/10', '10/11', '10/12', '10/13', '10/14'],
      },
      legend: {
        position: 'top',
        horizontalAlign: 'right',
        floating: true,
        offsetY: -25,
        offsetX: -5
      },
      fill: {
        type: 'gradient',
        gradient: {
          type: 'horizontal',
          colorStops: [
          {
            offset: 30,
            color: '#F7D63B',
            opacity: 1
          },
          {
            offset: 80,
            color: '#ED4B82',
            opacity: 1
          }]
        },
      },
      annotations: {
        xaxis: [{
          x: '10/9',
          x2: '10/11',
          fillColor: '#ED4B82',
          opacity: 0.3,
        },
        {
          x: '10/10',
          borderColor: '#ED4B82',
        }]
      }
    };

    // 3. Basic Bar Chart
    const basicBarOptions = {
      series: [{
        name: '',
        data: [10.1, 4, 4, 3.6, 3.2, 3.1, 2.3, 1.3, 0.8,]
      }],
      chart: {
        type: 'bar',
        height: 350,
        toolbar: {
          show: false
        }
      },
      plotOptions: {
        bar: {
          horizontal: true,
          borderRadius: 5,
          distributed: true,
          dataLabels: {
            position: 'top'
          },
        //   borderRadiusApplication: 'end'
        }
      },
      legend: {
        show: false
      },
      colors: ['#FF9800', '#FF9800', '#FF9800', '#2E93FA', '#2E93FA', '#2E93FA', '#2E93FA', '#2E93FA', '#2E93FA', '#2E93FA'],
      dataLabels: {
        enabled: true,
        textAnchor: 'start',
        style: {
            colors: ['#000000']
        },
        offsetX: 15,
        formatter: function (val) {
          return val + "%"
        }
      },
      stroke: {
        show: true,
        width: 1,
        // colors: ['transparent']
      },
      xaxis: {
        categories: ['코딩 불균일 문제', '점착성 문제', '코딩 박리', '코팅 색상 불균일', '코팅 속도 변동', '온도 관리 문제', '입자 분리', '코팅 두께 초과/미달', '코팅 기계의 마모'],
        axisTicks: {
          show: false
        }
      },
      grid: {
        xaxis: {
          lines: {
            show: true
          }
        },
        yaxis: {
          lines: {
            show: false
          }
        }
      },
      fill: {
        opacity: 1
      },
      tooltip: {
        y: {
          formatter: function (val) {
            return val + "%"
          }
        }
      }
    };
    
    // 4. Heatmap Chart
    const heatmapOptions = {
      series: [{
        name: '코팅기',
        data: [0, 15, 8, 0, 0, 1, 30, 25, 3]
      },{
        name: '드라이어',
        data: [0, 0, 6, 50, 60, 48, 15, 0, 0]
      },{
        name: '칼렌더',
        data: [0, 12, 8, 0, 0, 2, 23, 25, 10]
      },{
        name: '혼합기',
        data: [50, 35, 12, 20, 12, 1, 0, 8, 42]
      },{
        name: '필터 시스템',
        data: [0, 0, 0, 0, 0, 0, 0, 0, 0]
      },{
        name: '두께 측정',
        data: [0, 0, 18, 15, 58, 38, 12, 2, 0]
      },{
        name: '코팅액 공급기',
        data: [0, 20, 8, 0, 0, 1, 12, 25, 3]
      }],
      chart: {
        height: 350,
        type: 'heatmap',
        toolbar: {
          show: false
        }
      },
      plotOptions: {
        heatmap: {
          shadeIntensity: 0.3,
          colorScale: {
            ranges: [{
              from: 0,
              to: 10,
              name: 'low',
              color: '#2E93FA'
            },
            {
              from: 11,
              to: 20,
              name: 'medium low',
              color: '#00E396'
            },
            {
              from: 21,
              to: 30,
              name: 'medium',
              color: '#FDD835'
            },
            {
              from: 31,
              to: 45,
              name: 'high',
              color: '#FF9800'
            },
            {
              from: 46,
              to: 60,
              name: 'extreme',
              color: '#ED4B82'
            }]
          }
        }
      },
      legend: {
        show: false
      },
      dataLabels: {
        enabled: false
      },
      xaxis: {
        labels: {
          show: true
        },
        axisBorder: {
          show: false
        },
        axisTicks: {
          show: false
        }
      },
    }
 

    // Initialize Charts
    document.addEventListener('DOMContentLoaded', function() {
      const treemapChart = new ApexCharts(document.querySelector("#treemap-chart"), treemapOptions);
      const gradientLineChart = new ApexCharts(document.querySelector("#gradient-line-chart"), gradientLineOptions);
      const basicBarChart = new ApexCharts(document.querySelector("#basic-bar-chart"), basicBarOptions);
      const bubbleChart = new ApexCharts(document.querySelector("#simple-bubble-chart"), heatmapOptions);
      
      treemapChart.render();
      gradientLineChart.render();
      basicBarChart.render();
      bubbleChart.render();
    });
    // function setViewport() {

    //   let scale = 1;
    //   if (window.innerWidth <= 980) {
    //     scale = 0.4;
    //   }
    //   else if (window.innerWidth <= 1024) {
    //     scale = 0.6;
    //   }
    //   let meta = document.createElement('meta');
    //   meta.name = "viewport";
    //   meta.content = `width=device-width, initial-scale=${scale}, maximum-scale=${scale}, user-scalable=no`;
    //   document.head.appendChild(meta);
    // }
	  // setViewport();
    // window.addEventListener('resize', setViewport);
    //window.addEventListener('resize', adjustScale);
    // 기본 화면 크기 80%로 설정
    // document.body.style.zoom = "80%";

    function adjustScale() {
      let scale = 1;

      if (window.innerWidth <= 640) {
        scale = 0.6;
      }
      else if (window.innerWidth <= 768) {
        scale = 0.8;
      }
      else if (window.innerWidth <= 1024) {
        scale = 0.9;
      }

      document.querySelector('body').style.zoom = scale;
    }
    adjustScale();
    window.addEventListener('resize', adjustScale);
  </script>
</body>
</html>
